
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>wetherapp — Picture-Choice Mini Interview</title>
  <style>
    :root{
      --green:#4CAF50;
      --red:#F44336;
      --blue:#2196F3;
      --gray:#9E9E9E;
      --yellow:#FFC107;
    }
    *{box-sizing:border-box}
    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      margin:0;
      background:#0b0c0f;
      color:#e8e9ee;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    .container{
      max-width:960px;
      margin:0 auto;
      padding:24px;
    }
    header{
      display:flex;align-items:center;justify-content:space-between;
      gap:16px;margin-bottom:16px
    }
    .brand{
      display:flex;align-items:center;gap:12px
    }
    .brand .logo{font-size:28px}
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      border:1px solid rgba(255,255,255,0.08);
      border-radius:16px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.35);
      overflow:hidden;
    }
    .pad{padding:20px}
    .muted{color:#b7bac3}
    .progress{
      height:8px;background:rgba(255,255,255,0.12);border-radius:999px;overflow:hidden;margin:8px 0 16px;
    }
    .progress > div{
      height:100%;width:0%;background:linear-gradient(90deg, var(--blue), var(--green));
      transition:width .25s ease;
    }
    .question-title{font-size:20px;margin:8px 0 4px}
    .subtitle{font-size:14px;color:#c8cad2;margin-bottom:8px}
    .grid{
      display:grid;grid-template-columns: repeat(5, minmax(0,1fr));gap:12px;
    }
    @media (max-width:880px){
      .grid{grid-template-columns: repeat(2, minmax(0,1fr));}
    }
    .choice{
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(255,255,255,0.02);
      border-radius:14px;
      overflow:hidden;
      cursor:pointer;
      transition: transform .1s ease, border-color .2s ease, background .2s ease;
      display:flex;flex-direction:column;align-items:stretch;justify-content:stretch;
    }
    .choice:hover{transform:translateY(-2px);border-color:rgba(255,255,255,0.28);background:rgba(255,255,255,0.05)}
    .choice img{
      width:100%;aspect-ratio: 4/3;object-fit:cover;display:block;
      background:#111;
    }
    .choice .label{
      padding:10px 12px;font-size:14px;color:#d9dbe3;min-height:44px;display:flex;align-items:center;justify-content:center;text-align:center
    }
    .footer{
      display:flex;align-items:center;justify-content:space-between;gap:12px;margin-top:12px
    }
    .btn{
      appearance:none;border:1px solid rgba(255,255,255,0.14);
      background:#14161a;color:#f0f1f6;border-radius:12px;padding:10px 14px;
      cursor:pointer;font-weight:600;letter-spacing:.2px;
    }
    .btn.primary{background:linear-gradient(90deg, var(--blue), var(--green)); border:none;color:#071018}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    .result{
      display:none;text-align:center;padding:40px 20px;
    }
    .badge{
      display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:999px;font-weight:700;
      border:1px solid rgba(255,255,255,0.14);
      background:rgba(255,255,255,0.04);
    }
    .swatch{
      width:14px;height:14px;border-radius:50%;
      box-shadow:0 0 0 2px rgba(255,255,255,.2) inset;
    }
    .hidden{display:none !important}
    .hint{font-size:12px;color:#a7aab4;margin-top:6px}
    a.inline{color:#a7c7ff}
    /* simple emoji fallback heading */
    .emoji{font-size:20px;margin-right:6px}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo">🌍</div>
        <div>
          <div style="font-weight:800;letter-spacing:.3px">wetherapp</div>
          <div class="muted" style="font-size:12px">Picture‑Choice Mini Interview</div>
        </div>
      </div>
      <button id="restartBtn" class="btn" style="display:none">Restart</button>
    </header>

    <div class="card">
      <div class="pad">
        <div id="intro">
          <h2 style="margin:0 0 8px">Let’s find your inner weather</h2>
          <p class="muted">Pick the picture that feels most like you — no words needed.</p>
          <button id="startBtn" class="btn primary">Start</button>
          <div class="hint">This demo uses placeholder images. Replace the <code>src</code> values with your own assets.</div>
        </div>

        <div id="quiz" class="hidden">
          <div class="progress"><div id="bar"></div></div>
          <div id="qwrap"></div>
          <div class="footer">
            <div class="muted" id="qcount"></div>
            <div style="display:flex;gap:8px">
              <button id="backBtn" class="btn">Back</button>
              <button id="nextBtn" class="btn primary" disabled>Next</button>
            </div>
          </div>
        </div>

        <div id="result" class="result">
          <h2 class="question-title">Your feeling today</h2>
          <div id="finalBadge" class="badge" style="margin:10px auto"></div>
          <p class="muted">You can now store this emotion and place a dot on the map.</p>
          <div style="display:flex;gap:8px;justify-content:center;margin-top:10px">
            <button id="storeBtn" class="btn primary">Store Result (stub)</button>
            <button id="againBtn" class="btn">Try Again</button>
          </div>
        </div>

      </div>
    </div>

    <p class="hint" style="margin-top:12px">Implementation note: each picture choice carries a hidden <code>data-emotion</code> that maps to one of the five categories.</p>
    <p class="hint">Emotions & colors — 🌱 Hopeful <span class="swatch" style="background:var(--green)"></span> · 🔥 Angry <span class="swatch" style="background:var(--red)"></span> · 💧 Sad <span class="swatch" style="background:var(--blue)"></span> · ⚪ Neutral <span class="swatch" style="background:var(--gray)"></span> · ⚡ Anxious <span class="swatch" style="background:var(--yellow)"></span></p>
  </div>

  <script>
    // Placeholder image data URIs (simple SVGs) — replace with your own assets/URLs
    const svg = (emoji, bg) => 
      'data:image/svg+xml;utf8,' + encodeURIComponent(`
        <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 300'>
          <defs>
            <linearGradient id='g' x1='0' x2='1'>
              <stop offset='0' stop-color='${bg}' stop-opacity='0.9' />
              <stop offset='1' stop-color='${bg}' stop-opacity='0.6' />
            </linearGradient>
          </defs>
          <rect width='400' height='300' rx='24' fill='url(#g)'/>
          <text x='50%' y='54%' dominant-baseline='middle' text-anchor='middle' font-size='120'>${emoji}</text>
        </svg>
      `);

    const assets = {
      hopeful: {
        // Q1 sunrise sky; Q2 calm river; Q3 flute; Q4 green field; Q5 rising spiral
        q1: { img: svg('🌅', '#4CAF50'), label: 'Clear sunrise sky' },
        q2: { img: svg('🏞️', '#4CAF50'), label: 'Calm river flowing' },
        q3: { img: svg('🎼', '#4CAF50'), label: 'Soft flute' },
        q4: { img: svg('🌿', '#4CAF50'), label: 'Green field in spring' },
        q5: { img: svg('🌀', '#4CAF50'), label: 'Rising spiral' },
        color: 'var(--green)', emoji: '🌱', title: 'Hopeful / Optimistic'
      },
      angry: {
        q1: { img: svg('☀️', '#F44336'), label: 'Blazing hot sun' },
        q2: { img: svg('🏃‍♂️', '#F44336'), label: 'Running uphill' },
        q3: { img: svg('🥁', '#F44336'), label: 'Pounding drum' },
        q4: { img: svg('🌋', '#F44336'), label: 'Volcano erupting' },
        q5: { img: svg('🔺', '#F44336'), label: 'Sharp triangle' },
        color: 'var(--red)', emoji: '🔥', title: 'Angry / Frustrated'
      },
      sad: {
        q1: { img: svg('🌧️', '#2196F3'), label: 'Rain falling' },
        q2: { img: svg('🪵', '#2196F3'), label: 'Sitting still' },
        q3: { img: svg('🎻', '#2196F3'), label: 'Lone cello' },
        q4: { img: svg('🌳', '#2196F3'), label: 'Weeping willow' },
        q5: { img: svg('💧', '#2196F3'), label: 'Drooping teardrop' },
        color: 'var(--blue)', emoji: '💧', title: 'Sad / Grieving'
      },
      neutral: {
        q1: { img: svg('☁️', '#9E9E9E'), label: 'Overcast sky' },
        q2: { img: svg('🛣️', '#9E9E9E'), label: 'Straight empty road' },
        q3: { img: svg('⏱️', '#9E9E9E'), label: 'Steady metronome' },
        q4: { img: svg('🏜️', '#9E9E9E'), label: 'Flat plain' },
        q5: { img: svg('➖', '#9E9E9E'), label: 'Flat line' },
        color: 'var(--gray)', emoji: '⚪', title: 'Neutral / Indifferent'
      },
      anxious: {
        q1: { img: svg('⛈️', '#FFC107'), label: 'Thunderstorm' },
        q2: { img: svg('🚗', '#FFC107'), label: 'Busy highway' },
        q3: { img: svg('🎻', '#FFC107'), label: 'Buzzing string' },
        q4: { img: svg('🌊', '#FFC107'), label: 'Stormy ocean' },
        q5: { img: svg('⚡', '#FFC107'), label: 'Jagged zig‑zag' },
        color: 'var(--yellow)', emoji: '⚡', title: 'Anxious / Fearful'
      }
    };

    // Question definitions (text is for accessibility; UI is image-only)
    const questions = [
      { id:'q1', title:'If today’s weather matched you, it would be…' },
      { id:'q2', title:'Which pace matches your mood right now?' },
      { id:'q3', title:'If your body was an instrument today, it would be…' },
      { id:'q4', title:'The world around you feels like…' },
      { id:'q5', title:'If you were a shape right now, you’d be…' }
    ];

    // Build options per question from the "Example Question Set with Picture Choices"
    function buildOptions(qid){
      // Order: hopeful, angry, sad, neutral, anxious
      return [
        { emotion:'hopeful',  ...assets.hopeful[qid]  },
        { emotion:'angry',    ...assets.angry[qid]    },
        { emotion:'sad',      ...assets.sad[qid]      },
        { emotion:'neutral',  ...assets.neutral[qid]  },
        { emotion:'anxious',  ...assets.anxious[qid]  },
      ];
    }

    // State
    let current = 0;
    const scores = { hopeful:0, angry:0, sad:0, neutral:0, anxious:0 };
    const answers = [null, null, null, null, null];

    // Elements
    const intro = document.getElementById('intro');
    const quiz = document.getElementById('quiz');
    const qwrap = document.getElementById('qwrap');
    const qcount = document.getElementById('qcount');
    const bar = document.getElementById('bar');
    const nextBtn = document.getElementById('nextBtn');
    const backBtn = document.getElementById('backBtn');
    const restartBtn = document.getElementById('restartBtn');
    const result = document.getElementById('result');
    const storeBtn = document.getElementById('storeBtn');
    const againBtn = document.getElementById('againBtn');
    const finalBadge = document.getElementById('finalBadge');

    function renderQuestion(){
      const q = questions[current];
      const opts = buildOptions(q.id);
      qwrap.innerHTML = `
        <div class="question-title">${q.title}</div>
        <div class="subtitle">Choose one picture that feels right.</div>
        <div class="grid">
          ${opts.map((o,idx)=>`
            <button class="choice" data-emotion="${o.emotion}" data-index="${idx}" aria-label="${o.label}">
              <img src="${o.img}" alt="${o.label}"/>
              <div class="label">${o.label}</div>
            </button>
          `).join('')}
        </div>
      `;
      qcount.textContent = `Question ${current+1} of ${questions.length}`;
      bar.style.width = ((current)/questions.length*100)+'%';
      nextBtn.disabled = answers[current] == null;
      backBtn.disabled = current === 0;

      // re-apply selected state if user went back
      if(answers[current]){
        const selected = [...qwrap.querySelectorAll('.choice')]
          .find(el => el.dataset.emotion === answers[current]);
        if(selected) selected.style.borderColor = 'white';
      }

      // listeners
      qwrap.querySelectorAll('.choice').forEach(el => {
        el.addEventListener('click', () => {
          // clear borders
          qwrap.querySelectorAll('.choice').forEach(c => c.style.borderColor = 'rgba(255,255,255,0.12)');
          el.style.borderColor = 'white';
          answers[current] = el.dataset.emotion;
          nextBtn.disabled = false;
        });
      });
    }

    function computeResult(){
      // reset scores
      scores.hopeful = scores.angry = scores.sad = scores.neutral = scores.anxious = 0;
      answers.forEach(em => { if(em) scores[em] += 1; });

      // get max & ties
      const entries = Object.entries(scores);
      const maxVal = Math.max(...entries.map(([,v])=>v));
      const tied = entries.filter(([,v])=>v===maxVal).map(([k])=>k);

      // random pick on tie
      const chosen = tied[Math.floor(Math.random()*tied.length)];
      return chosen;
    }

    function showResult(){
      const final = computeResult();
      const set = assets[final];
      finalBadge.innerHTML = `
        <span class="swatch" style="background:${set.color}"></span>
        <span class="emoji">${set.emoji}</span>
        <span>${set.title}</span>
      `;
      document.documentElement.style.setProperty('--accent', set.color);
      quiz.classList.add('hidden');
      result.style.display = 'block';
      bar.style.width = '100%';
      restartBtn.style.display = 'inline-block';
    }

    function resetAll(){
      current = 0;
      for (const k in scores) scores[k]=0;
      answers.fill(null);
      result.style.display='none';
      intro.style.display='block';
      quiz.classList.add('hidden');
      restartBtn.style.display = 'none';
      bar.style.width = '0%';
    }

    // Navigation
    document.getElementById('startBtn').addEventListener('click', () => {
      intro.style.display='none';
      quiz.classList.remove('hidden');
      renderQuestion();
    });

    nextBtn.addEventListener('click', () => {
      if(current < questions.length-1){
        current += 1;
        renderQuestion();
      } else {
        showResult();
      }
    });

    backBtn.addEventListener('click', () => {
      if(current > 0){
        current -= 1;
        renderQuestion();
      }
    });

    againBtn.addEventListener('click', resetAll);
    restartBtn.addEventListener('click', resetAll);

    // Stub: storing result (replace with your API call to MongoDB backend)
    storeBtn.addEventListener('click', () => {
      const final = computeResult();
      alert('Store this result to DB: ' + final);
      // TODO: POST /api/feelings { emotion: final }
    });
  </script>
</body>
</html>
